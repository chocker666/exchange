#include <arpa/inet.h>
#include <netinet/in.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <unistd.h>

int main()
{
  //创建套接字
  int serv_sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

  //将套接字和IP、端口绑定
  struct sockaddr_in serv_addr;
  memset(&serv_addr, 0, sizeof(serv_addr));            //每个字节都用0填充
  serv_addr.sin_family = AF_INET;                      //使用IPv4地址
  serv_addr.sin_addr.s_addr = INADDR_ANY;  //具体的IP地址
  serv_addr.sin_port = htons(5300);                    //端口
  bind(serv_sock, (struct sockaddr*)&serv_addr, sizeof(serv_addr));

  //进入监听状态，等待用户发起请求
  listen(serv_sock, 20);

  //接收客户端请求
  struct sockaddr_in clnt_addr;
  socklen_t clnt_addr_size = sizeof(clnt_addr);
  int clnt_sock = accept(serv_sock, (struct sockaddr*)&clnt_addr, &clnt_addr_size);

  //向客户端发送数据
  char str[] =
      "{\"Start\":\"LS\",\"Stamp\":\"666\",\"CMD\":\"ST1\",\"DATA\":\"-200,-200,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200?-200,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200?-200,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-200,-200,-200,-200,-200,-200,-3,-200,-3,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,128,124,126,-200,-200,-200,-200,-200,-200,-200?-200,-3,-200,-3,-3,121,121,124,121,124,121,124,121,121,121,121,119,124,121,124,121,124,124,121,124,124,124,124,124,124,-200,-3,-200,-3,124,124,124,126,124,126,126,126,126,121,126,124,124,126,-200,-200?-200,-200,-200,126,124,124,121,121,119,119,121,121,121,121,121,121,121,121,124,121,124,121,124,121,121,124,121,124,124,-200,-200,-200,-200,-200,121,112,124,124,119,119,121,37,121,109,112,124,116,116,-200,-200?-200,-200,124,124,119,119,119,124,116,114,116,114,114,112,112,112,107,104,116,112,-200,-200,-200,-200,102,-200,-200,-200,-200,-200,1,4,-200,18,25,30,-200,47,37,30,32,32,35,32,27,30,44,-200,116,-200?-200,-200,121,116,73,56,-200,-200,-200,-200,-200,-200,-12,-200,-200,-200,-39,-39,-43,-46,-41,-43,-48,-46,-43,-41,-43,-46,-36,-29,-19,0,-10,-15,-15,0,13,27,35,27,30,37,-3,37,27,23,25,104,-200,-200?-200,-200,124,121,66,47,35,20,6,6,-29,-27,-27,-41,-48,-51,-51,-53,-51,-48,-51,-48,-48,-46,-46,-46,-51,-56,-48,-27,-27,-22,-22,-27,-22,-17,4,8,18,27,27,20,25,13,16,23,30,32,-200,-200?-200,-200,124,121,83,61,8,-19,-22,-36,-41,-53,-56,-58,-63,-63,-65,-68,-70,-72,-63,-68,-70,-60,-70,-68,-70,-56,-53,-46,-51,-43,-19,-27,-41,-39,-36,-22,-15,-5,6,4,8,16,16,20,27,42,-200,-200?-200,-200,124,124,68,-200,-22,-32,-34,-48,-51,-60,-63,-68,-72,-75,-77,-80,-77,-75,-72,-72,-84,-82,-87,-87,-80,-87,-75,-53,-58,-58,-63,-60,-56,-53,-48,-39,-24,-27,-12,-8,0,20,20,20,27,44,83,-200?-200,-200,121,124,87,-200,-29,-41,-48,-53,-58,-63,-58,-70,-72,-80,-84,-84,-77,-72,-65,-70,-77,-84,-94,-99,-94,-84,-63,-58,-63,-68,-68,-65,-60,-56,-46,-39,-34,-34,-24,-12,13,-3,18,16,27,30,87,-200?-200,-200,124,121,83,-200,-36,-56,-63,-68,-68,-65,-60,-65,-72,-75,-82,-84,-75,-68,-53,-63,-70,-77,-96,-99,-94,-87,-75,-63,-65,-70,-68,-70,-68,-63,-58,-48,-36,-29,-24,-12,8,20,20,25,25,44,92,-200?-200,-200,-200,124,-200,-200,-43,-65,-75,-80,-72,-70,-65,-65,-70,-72,-87,-87,-80,-56,-51,-60,-65,-82,-94,-99,-96,-82,-70,-68,-70,-72,-70,-68,-68,-60,-51,-39,-41,-32,-24,-22,18,20,27,-3,35,54,61,-200?-200,-200,124,124,112,-41,-56,-70,-82,-80,-75,-70,-70,-70,-68,-77,-82,-89,-70,-63,-56,-63,-70,-80,-94,-96,-92,-84,-80,-80,-70,-77,-72,-70,-63,-56,-53,-56,-48,-48,-36,-27,-19,-3,16,27,44,56,80,-200?-200,-200,124,126,-200,-48,-63,-72,-87,-82,-72,-70,-63,-70,-70,-77,-80,-84,-77,-72,-63,-65,-70,-84,-94,-94,-96,-94,-89,-82,-77,-77,-75,-75,-70,-63,-60,-56,-48,-39,-27,-19,-19,-10,11,27,35,54,97,-200?-200,-200,124,126,-200,-43,-63,-75,-82,-75,-68,-63,-63,-65,-70,-77,-80,-82,-82,-72,-75,-72,-80,-87,-96,-94,-200,-200,-80,-77,-200,-200,-72,-72,-72,-68,-63,-51,-41,-36,-22,-19,-15,0,11,16,42,59,83,-200?-200,-200,126,124,121,-46,-56,-80,-82,-68,-60,-53,-58,-65,-68,-80,-80,-72,-82,-84,-80,-84,-82,-94,-99,-99,-84,-87,-80,-77,-72,-200,-200,-3,-70,-63,-58,-46,-41,-36,-27,-19,-15,6,8,20,42,52,64,-200?-200,-200,124,126,112,-51,-65,-80,-72,-65,-60,-48,-51,-58,-70,-75,-75,-72,-84,-87,-92,-94,-92,-118,-96,-92,-89,-87,-84,-80,-75,-200,-3,-3,-70,-63,-58,-43,-36,-27,-19,-17,-5,8,16,23,44,52,87,-200?-200,-200,126,126,126,-51,-63,-63,-58,-65,-56,-51,-46,-53,-65,-75,-77,-80,-84,-94,-99,-104,-99,-99,-99,-92,-89,-89,-200,-75,-75,-75,-3,-3,-3,-65,-63,-48,-34,-24,-19,-12,-3,4,13,11,32,56,85,95?-200,-200,126,128,124,-200,-63,-53,-60,-60,-53,-51,-51,-58,-70,-75,-84,-92,-94,-99,-104,-104,-104,-104,-96,-94,-89,-89,-82,-82,-80,-70,-3,-3,-3,-68,-65,-46,-34,-24,-19,-15,0,4,8,6,20,66,87,92?-200,-200,128,128,128,-200,-51,-56,-70,-70,-65,-56,-58,-63,-72,-80,-87,-94,-99,-104,-101,-104,-101,-101,-96,-94,-89,-84,-82,-82,-75,-70,-70,-65,-3,-60,-46,-43,-32,-24,-22,-19,-8,6,4,4,32,59,61,-200?-200,-200,126,128,126,-58,-70,-63,-82,-77,-63,-60,-60,-68,-77,-87,-99,-96,-104,-106,-104,-104,-99,-96,-96,-96,-89,-87,-84,-77,-75,-65,-63,-63,-60,-56,-53,-46,-41,-29,-19,-12,1,4,-3,0,30,64,68,-200?-200,-200,128,128,131,-60,-75,-89,-87,-77,-68,-63,-65,-70,-80,-92,-96,-104,-101,-106,-106,-104,-104,-99,-94,-94,-84,-87,-80,-75,-72,-68,-63,-58,-56,-56,-53,-46,-41,-34,-27,-27,-19,-10,-5,-5,30,54,68,-200?-200,-200,131,128,133,-68,-87,-87,-87,-84,-72,-77,-70,-75,-82,-92,-96,-99,-104,-101,-99,-104,-104,-92,-89,-89,-84,-77,-80,-68,-72,-68,-63,-60,-58,-51,-53,-46,-43,-34,-32,-32,-27,-19,-8,-27,27,32,59,-200?-200,-200,133,133,133,-63,-80,-84,-84,-89,-84,-75,-75,-75,-84,-92,-96,-96,-99,-101,-99,-101,-94,-94,-87,-82,-77,-80,-70,-70,-70,-63,-63,-60,-51,-48,-48,-43,-39,-39,-32,-27,-27,-24,-15,-10,25,32,56,73?-200,-200,136,133,133,-200,-75,-84,-82,-84,-89,-80,-72,-75,-84,-84,-84,-94,-96,-99,-94,-94,-92,-87,-82,-75,-77,-65,-63,-68,-63,-65,-63,-56,-53,-46,-43,-36,-36,-32,-32,-34,-24,-24,-17,-15,1,27,52,-200?-200,-200,138,138,136,-200,-72,-84,-80,-84,-82,-82,-75,-72,-82,-75,-77,-82,-87,-94,-94,-94,-92,-84,-75,-70,-70,-68,-63,-63,-58,-48,-46,-43,-43,-43,-36,-36,-36,-32,-32,-19,-19,-19,-3,-17,6,11,49,56?-200,-200,133,138,133,-200,-72,-77,-75,-80,-72,-70,-68,-70,-72,-72,-75,-75,-75,-92,-89,-84,-77,-75,-68,-63,-60,-60,-53,-56,-56,-41,-39,-34,-39,-36,-34,-32,-27,-29,-22,-19,-22,-15,-12,-12,1,20,30,52?-200,-200,136,138,131,-200,-75,-75,-72,-70,-68,-63,-65,-63,-60,-70,-70,-70,-77,-82,-75,-75,-63,-53,-51,-43,-51,-46,-41,-48,-48,-36,-29,-27,-29,-17,-22,-17,-17,-19,-15,-17,-19,-12,-8,-8,0,11,35,-200?-200,-200,133,136,133,-200,-56,-65,-70,-70,-60,-63,-60,-53,-53,-53,-63,-63,-63,-72,-68,-58,-53,-46,-36,-32,-29,-27,-34,-34,-32,-27,-17,-15,-15,-8,-3,-3,-8,-5,4,-3,-5,-3,-8,-5,-5,0,27,49?-200,-200,136,136,133,-200,-58,-60,-60,-56,-58,-53,-39,-46,-46,-51,-46,-56,-51,-51,-53,-48,-36,-29,-27,-17,-17,-15,-17,-15,-17,-15,-8,-8,-3,1,4,1,11,4,6,11,4,0,0,4,4,-3,23,42?-200,-200,136,136,136,-200,-48,-53,-48,-48,-43,-41,-32,-32,-34,-32,-39,-36,-46,-41,-32,-22,-22,-15,-15,-12,-5,0,0,4,-12,-3,0,-3,4,11,8,11,18,18,18,16,11,11,6,4,4,8,23,37?-200,-200,131,133,133,-200,-41,-39,-41,-41,-39,-34,-29,-29,-15,-15,-19,-29,-24,-27,-19,-15,-5,-3,-3,4,0,0,1,1,1,4,0,0,11,18,27,27,27,30,27,20,20,20,8,11,11,13,16,30?-200,-200,133,136,136,-200,-39,-32,-39,-41,-32,-24,-17,-10,-8,0,1,-15,-15,-10,-12,-3,0,1,1,6,4,6,11,16,8,16,11,11,25,37,44,44,39,27,27,27,25,39,30,25,-3,-3,11,35?-200,-200,133,136,138,-200,-29,-24,-34,-27,-19,-15,-5,-3,1,1,4,6,0,1,1,0,0,4,6,8,16,16,20,23,25,18,18,35,37,39,44,47,42,42,44,54,37,39,39,25,-3,20,16,25?-200,-200,133,140,138,-200,-24,-19,-27,-17,-15,-3,0,1,1,8,11,13,4,4,4,4,18,20,20,25,27,27,32,39,39,35,39,52,59,54,52,49,68,68,59,56,52,39,39,-3,16,30,13,18?-200,-200,133,138,140,-200,1,-12,-15,-12,-5,0,1,4,4,16,20,20,11,16,18,32,37,32,32,37,37,35,39,52,49,52,56,64,66,59,56,61,68,68,71,54,52,39,39,37,32,32,-3,20?-200,-200,138,136,140,-200,11,1,1,0,0,1,8,16,16,16,18,20,27,27,35,44,39,44,42,42,42,44,47,54,59,61,68,66,66,66,66,66,71,68,73,64,56,52,42,42,-3,35,37,37?-200,-200,133,136,140,102,35,6,8,4,1,8,16,20,20,20,23,27,37,39,44,52,49,52,44,47,47,49,44,54,59,68,73,75,75,68,66,64,68,68,71,68,61,59,44,47,47,49,44,32?-200,-200,133,136,145,112,42,8,8,6,0,8,13,20,20,27,27,27,47,44,44,54,49,52,47,52,47,47,52,52,59,68,68,73,78,68,68,64,68,73,73,71,66,59,52,56,52,52,52,47?-200,-200,133,138,143,126,47,11,6,8,0,8,16,20,23,27,27,27,39,44,39,54,49,52,49,52,47,42,39,52,56,66,68,71,75,71,68,64,73,75,75,68,66,61,56,52,52,54,56,47?-200,-200,136,138,145,121,-200,11,1,6,1,11,18,25,27,25,30,27,42,39,39,44,44,49,49,52,47,42,44,47,52,61,66,73,78,78,71,68,66,80,75,75,64,59,54,52,49,52,47,44?-200,-200,138,138,145,131,42,8,4,4,0,4,16,23,18,25,23,25,30,32,30,35,32,39,47,47,42,44,44,44,52,59,66,73,78,78,71,68,68,73,78,73,64,56,49,44,35,39,42,39?-200,-200,136,138,143,138,30,1,0,1,0,1,1,13,16,13,18,18,20,20,20,13,13,27,44,52,52,42,39,42,42,49,59,61,75,71,73,64,61,68,56,66,56,44,32,35,30,27,32,23?-200,-200,-200,138,140,138,-200,0,0,-8,-8,-3,0,4,1,4,4,16,6,1,8,16,16,25,35,49,42,39,37,27,25,35,39,49,44,49,56,44,44,44,47,42,25,23,20,20,23,27,16,20?-200,-200,136,138,143,136,-200,0,-8,-10,-15,-8,0,0,-17,-15,0,1,1,4,4,13,13,16,16,30,23,18,16,8,11,11,23,27,16,27,25,27,16,23,23,20,18,8,8,4,6,16,6,27?-200,-200,-200,140,140,140,-200,4,-15,-17,-22,-19,-24,-27,-32,-32,-17,1,8,0,4,1,0,-12,-19,1,1,0,0,-8,1,4,16,1,6,1,6,8,8,4,8,8,4,0,-5,0,0,0,4,32?-200,-200,-200,136,140,140,-200,-12,-19,-24,-24,-27,-51,-39,-32,-29,-22,-19,-29,-34,-36,-41,-36,-32,-32,-24,-24,-19,-15,-15,-15,-8,0,-10,-8,-15,-12,-12,-5,1,1,4,0,-3,-10,-8,0,4,4,20?-200,-200,-200,140,143,143,-200,8,-19,-22,-53,-53,-53,-46,-46,-43,-41,-36,-39,-41,-43,-53,-56,-48,-43,-34,-29,-24,-19,-22,-19,-22,-27,-19,-24,-22,-22,-19,-19,-15,-8,-10,-19,-10,-10,-8,-10,0,8,35?-200,-200,-200,140,140,138,-200,11,-46,-51,-48,-56,-58,-56,-58,-58,-53,-56,-58,-63,-63,-70,-63,-60,-53,-51,-39,-36,-27,-32,-29,-32,-36,-41,-36,-36,-36,-32,-29,-22,-17,-15,-15,-15,-17,-15,-8,0,8,20?-200,-200,-200,140,143,-200,-200,18,-46,-51,-51,-60,-63,-72,-70,-68,-68,-70,-70,-72,-87,-84,-80,-72,-68,-60,-56,-43,-41,-43,-41,-43,-46,-51,-51,-41,-46,-46,-29,-27,-22,-24,-24,-29,-19,-17,-10,0,1,30?-200,-200,-200,-200,143,-200,8,-10,-43,-56,-63,-70,-70,-80,-80,-77,-80,-82,-82,-84,-92,-94,-92,-92,-80,-72,-63,-56,-56,-51,-53,-53,-60,-63,-65,-53,-56,-60,-43,-39,-36,-36,-27,-27,-27,-22,-17,-10,4,27?-200,-200,8,-200,-200,-200,8,8,-41,-46,-63,-75,-77,-84,-84,-82,-87,-94,-94,-101,-104,-108,-101,-101,-84,-80,-70,-68,-65,-63,-68,-65,-75,-70,-63,-63,-65,-63,-46,-46,-39,-32,-34,-29,-29,-22,-17,-5,0,13?-200,6,-3,-200,-200,-200,13,1,-32,-39,-51,-75,-80,-89,-92,-92,-92,-99,-101,-108,-113,-118,-116,-116,-87,-82,-80,-80,-72,-70,-72,-75,-75,-75,-70,-63,-63,-58,-56,-48,-46,-39,-39,-34,-32,-24,-17,-5,4,23?-200,8,-3,-200,-200,-200,13,4,-22,-36,-46,-77,-84,-89,-92,-94,-99,-111,-111,-120,-125,-123,-125,-116,-92,-89,-84,-77,-75,-75,-75,-80,-72,-70,-68,-63,-60,-60,-56,-53,-48,-39,-41,-39,-24,-17,-17,-5,6,11?8,8,-3,-200,-200,-200,13,1,-22,-56,-75,-89,-96,-94,-94,-104,-104,-108,-118,-123,-135,-130,-128,-116,-87,-82,-80,-80,-77,-77,-77,-75,-77,-77,-70,-70,-63,-56,-60,-51,-46,-43,-41,-36,-8,-15,-8,0,4,18?8,8,-3,-200,-200,-200,16,6,-19,-43,-72,-87,-99,-104,-106,-106,-116,-128,-135,-135,-140,-135,-128,-120,-87,-80,-80,-80,-75,-75,-75,-77,-77,-77,-72,-63,-60,-60,-56,-51,-46,-43,-46,-43,-8,0,4,0,8,13?6,8,-3,-200,-200,-200,13,1,-12,-24,-72,-80,-99,-108,-108,-116,-123,-130,-132,-130,-137,-135,-116,-108,-82,-75,-72,-72,-75,-75,-77,-77,-77,-70,-60,-60,-58,-56,-56,-51,-48,-46,-43,-27,-22,-12,4,6,13,23?8,11,-3,-200,-200,-200,8,1,-12,-27,-51,-58,-87,-96,-118,-123,-118,-68,-56,-200,-200,-63,-46,-46,-39,-68,-63,-60,-63,-65,-48,-51,-51,-58,-51,-51,-56,-53,-53,-53,-51,-43,-48,-29,-17,-17,-10,1,8,37?8,11,-3,-200,-200,-200,1,-3,-12,-32,-43,-56,-75,-75,-77,-72,-56,-46,-19,-17,-10,-15,-17,-29,-34,-29,-43,-51,-39,-32,-27,-29,-15,-10,-43,-43,-48,-53,-51,-43,-51,-3,-43,-43,-12,-8,0,4,8,35?11,11,-3,-200,-200,-200,1,-8,-19,-34,-43,-60,-56,-56,-58,-48,-32,-17,-15,-15,0,0,-24,-32,-36,-32,-29,-32,-24,-27,-22,-19,-8,-3,-15,-41,-48,-51,-51,-46,-3,-3,-48,-39,-17,0,0,4,23,32?11,13,-3,-200,-200,-200,8,0,-15,-34,-39,-46,-56,-53,-46,-34,-27,-8,-15,-10,-17,-15,-19,-36,-43,-43,-48,-46,-43,-39,-39,-32,-19,-8,-12,-29,-43,-53,-56,-53,-3,-3,-53,-43,-17,-10,-10,1,16,37?11,-200,-3,-200,-200,39,13,1,-3,-19,-29,-43,-51,-51,-34,-29,-24,-5,-17,-22,-24,-24,-27,-39,-51,-58,-56,-58,-58,-56,-48,-39,-3,0,-15,-27,-43,-51,-56,-3,-3,-51,-48,-43,-24,-17,-3,0,11,-200?11,8,-3,-200,-200,-200,0,0,-15,-19,-27,-39,-36,-39,-36,-32,-19,0,-5,-19,-15,-22,-29,-51,-200,-200,-200,356,354,354,363,361,-200,-200,-200,-32,-39,-43,-58,-53,-3,-3,-46,-36,-19,-15,0,4,11,-200?11,11,-3,-200,-200,32,1,-3,-15,-24,-32,-34,-39,-34,-36,-29,-29,-29,-19,-39,-32,-17,-32,-43,-200,-200,342,378,373,376,371,368,378,-29,-200,-27,-36,-46,-51,-51,-3,-3,-51,-32,-15,-3,1,13,16,44?11,11,-3,-200,-200,32,1,0,-10,-22,-32,-32,-34,-34,-32,-29,-32,-41,-48,-51,-53,-51,-46,-48,-200,-60,383,368,363,385,376,371,380,-200,-200,-22,-17,-19,-29,-34,-39,-36,-29,-19,-15,-3,4,16,23,-200?-200,11,-3,-200,-200,32,6,4,-8,-19,-27,-32,-36,-32,-29,-24,-27,-46,-48,-53,-53,-53,-46,-51,-200,-53,-200,366,376,395,397,385,-200,-200,-200,1,1,-15,-27,-32,-36,-22,-12,-24,-15,-5,1,16,20,-200?-200,13,-3,-200,-200,-200,8,1,0,-12,-29,-32,-29,-27,-22,-17,-34,-39,-39,-51,-53,-56,-51,-43,-200,-48,-200,-200,-200,395,380,388,-200,-200,-200,-200,1,-3,-19,-22,-10,-3,6,4,0,11,18,27,32,-200?-200,-200,-200,-200,-200,-200,18,8,0,-8,-19,1,-17,-12,-8,-12,-34,-39,-43,-43,-48,-53,-51,-48,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,1,-3,-8,-12,0,6,6,8,8,25,27,47,52,-200?-200,-200,-200,-200,-200,-200,-200,8,1,4,1,0,-24,-39,-41,-56,-56,-53,-56,-63,-53,-53,-51,-51,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-200,-12,-12,-15,0,-8,-3,4,6,13,44,-200,-200,-200?\",\"End\":\"ZG\"}";
  write(clnt_sock, str, sizeof(str));

  //关闭套接字
  close(clnt_sock);
  close(serv_sock);

  return 0;
}
